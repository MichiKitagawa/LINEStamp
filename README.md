# LINEã‚¹ã‚¿ãƒ³ãƒ—è‡ªå‹•ç”Ÿæˆãƒ»ç”³è«‹ã‚·ã‚¹ãƒ†ãƒ 

## æ¦‚è¦
LINEã‚¹ã‚¿ãƒ³ãƒ—ã®è‡ªå‹•ç”Ÿæˆã‹ã‚‰ç”³è«‹ã¾ã§ä¸€æ‹¬ã§è¡Œã†Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã‹ã‚‰ã€AIã‚’æ´»ç”¨ã—ã¦LINEã‚¹ã‚¿ãƒ³ãƒ—ã‚’ç”Ÿæˆã—ã€è‡ªå‹•çš„ã«LINE Creators Marketã«ç”³è«‹ã‚’è¡Œã„ã¾ã™ã€‚

## æ©Ÿèƒ½
- Googleèªè¨¼ã«ã‚ˆã‚‹ä¼šå“¡ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ âœ…**å®Ÿè£…æ¸ˆã¿**
- ãƒˆãƒ¼ã‚¯ãƒ³åˆ¶èª²é‡‘ã‚·ã‚¹ãƒ†ãƒ ï¼ˆStripeæ±ºæ¸ˆï¼‰ âœ…**å®Ÿè£…æ¸ˆã¿**
- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠ âœ…**å®Ÿè£…æ¸ˆã¿**
- AIã«ã‚ˆã‚‹ã‚¹ã‚¿ãƒ³ãƒ—ç”Ÿæˆ ğŸš§**ãƒ¢ãƒƒã‚¯å®Ÿè£…**
- LINE Creators Marketã¸ã®è‡ªå‹•ç”³è«‹ ğŸš§**ãƒ¢ãƒƒã‚¯å®Ÿè£…**
- ç”³è«‹çŠ¶æ³ã®ç¢ºèªãƒ»ã‚¨ãƒ©ãƒ¼å¾©æ—§æ©Ÿèƒ½ âœ…**å®Ÿè£…æ¸ˆã¿**

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js, React, TypeScript, Tailwind CSS
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Express.js, TypeScript, Firebase Admin SDK
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Firebase Firestore âœ…**å®Ÿã‚µãƒ¼ãƒ“ã‚¹é€£æºæ¸ˆã¿**
- **èªè¨¼**: Firebase Authentication âœ…**å®Ÿã‚µãƒ¼ãƒ“ã‚¹é€£æºæ¸ˆã¿**
- **æ±ºæ¸ˆ**: Stripe âœ…**å®Ÿã‚µãƒ¼ãƒ“ã‚¹é€£æºæ¸ˆã¿**
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: Firebase Cloud Storage âœ…**å®Ÿã‚µãƒ¼ãƒ“ã‚¹é€£æºæ¸ˆã¿**
- **è‡ªå‹•åŒ–**: Puppeteer ğŸš§**ãƒ¢ãƒƒã‚¯å®Ÿè£…**
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: Google Cloud Run

## å®Ÿè£…çŠ¶æ³

### âœ… å®Ÿè£…å®Œäº†ãƒ»å®Ÿã‚µãƒ¼ãƒ“ã‚¹é€£æºæ¸ˆã¿
- **Firebaseèªè¨¼**: Googleèªè¨¼ã§ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
- **Firestore**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€ãƒˆãƒ¼ã‚¯ãƒ³æ®‹é«˜ã€ã‚¹ã‚¿ãƒ³ãƒ—ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†
- **Firebase Storage**: ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ç®¡ç†
- **Stripe**: ãƒˆãƒ¼ã‚¯ãƒ³è³¼å…¥ã€Webhookå‡¦ç†
- **èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢**: IDãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
- **ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**: ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œã®UIã¨API
- **ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†**: æ®‹é«˜ç¢ºèªã€æ¶ˆè²»å‡¦ç†
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: é©åˆ‡ãªã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã¨å¾©æ—§æ©Ÿèƒ½

### ğŸš§ ãƒ¢ãƒƒã‚¯å®Ÿè£…ï¼ˆå®Ÿã‚µãƒ¼ãƒ“ã‚¹å¾…ã¡ï¼‰
- **ç”»åƒç”ŸæˆAPI**: ç¾åœ¨ã¯ãƒ€ãƒŸãƒ¼ç”»åƒã‚’ç”Ÿæˆï¼ˆOpenAI DALL-Eç­‰ã®å®Ÿè£…å¾…ã¡ï¼‰
- **LINEç”³è«‹å‡¦ç†**: ç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯å‡¦ç†ï¼ˆå®Ÿéš›ã®Puppeteerè‡ªå‹•ç”³è«‹å®Ÿè£…å¾…ã¡ï¼‰

## é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶
- Node.js 18.xä»¥ä¸Š
- npm ã¾ãŸã¯ yarn
- Firebase CLI
- Git
- **Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ï¼ˆè¦ä½œæˆï¼‰
- **Stripe ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ï¼ˆè¦ä½œæˆï¼‰

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
```bash
git clone https://github.com/MichiKitagawa/LINEStamp.git
cd LINEStamp
```

### 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
# è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
chmod +x scripts/setup.sh
./scripts/setup.sh
```

ã¾ãŸã¯æ‰‹å‹•ã§ï¼š
```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
cd backend && npm install

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
cd ../frontend && npm install

# E2Eãƒ†ã‚¹ãƒˆ
cd ../e2e && npm install

# çµåˆãƒ†ã‚¹ãƒˆ
cd ../tests && npm install
```

### 3. Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### 3.1 Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
1. [Firebase Console](https://console.firebase.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
3. Authentication > Sign-in method ã§Googleèªè¨¼ã‚’æœ‰åŠ¹åŒ–
4. Firestore Database ã‚’ä½œæˆï¼ˆãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã§é–‹å§‹ï¼‰
5. Storage ã‚’æœ‰åŠ¹åŒ–

#### 3.2 ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã®ç”Ÿæˆ
1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š > ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
2. ã€Œæ–°ã—ã„ç§˜å¯†éµã®ç”Ÿæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
4. ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‹ã‚‰ä»¥ä¸‹ã®å€¤ã‚’å–å¾—ï¼š
   - `project_id`
   - `private_key`
   - `client_email`

### 4. Stripe ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### 4.1 Stripe ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§è¨­å®š
1. [Stripe Dashboard](https://dashboard.stripe.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. é–‹ç™ºè€… > APIã‚­ãƒ¼ã‹ã‚‰ä»¥ä¸‹ã‚’å–å¾—ï¼š
   - å…¬é–‹å¯èƒ½ã‚­ãƒ¼ (pk_test_...)
   - ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ (sk_test_...)
3. é–‹ç™ºè€… > Webhook ã§æ–°ã—ã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆï¼š
   - URL: `http://localhost:3001/tokens/webhook/stripe`
   - ã‚¤ãƒ™ãƒ³ãƒˆ: `checkout.session.completed`
   - Webhookç½²åã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’å–å¾—

### 5. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

#### 5.1 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (`backend/.env`)
```bash
# Firebaseè¨­å®š
FIREBASE_PROJECT_ID=your-firebase-project-id
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY\n-----END PRIVATE KEY-----\n"
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project.iam.gserviceaccount.com
FIREBASE_STORAGE_BUCKET=your-project.appspot.com

# Stripeè¨­å®š
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# ã‚µãƒ¼ãƒãƒ¼è¨­å®š
PORT=3001
NODE_ENV=development
```

#### 5.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (`frontend/.env.local`)
```bash
# Firebaseè¨­å®š
NEXT_PUBLIC_FIREBASE_API_KEY=your-firebase-api-key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your-firebase-project-id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your-messaging-sender-id
NEXT_PUBLIC_FIREBASE_APP_ID=your-firebase-app-id

# APIè¨­å®š
NEXT_PUBLIC_API_BASE_URL=http://localhost:3001

# Stripeè¨­å®š
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
```

### 6. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

#### 6.1 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆãƒãƒ¼ãƒˆ3001ï¼‰
```bash
cd backend
npm run dev
```

#### 6.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆãƒãƒ¼ãƒˆ3000ï¼‰
```bash
cd frontend
npm run dev
```

### 7. å‹•ä½œç¢ºèª

1. http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹
2. Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³
3. ãƒˆãƒ¼ã‚¯ãƒ³è³¼å…¥æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆï¼ˆãƒ†ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ï¼‰
4. ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ

## ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
cd backend && npm test

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
cd frontend && npm test
```

### çµåˆãƒ†ã‚¹ãƒˆ
```bash
# Firestoreã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’èµ·å‹•
firebase emulators:start --only firestore

# çµåˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
cd tests && npm test
```

### E2Eãƒ†ã‚¹ãƒˆ
```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•å¾Œ
cd e2e && npx playwright test
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Firebaseæ¥ç¶šã‚¨ãƒ©ãƒ¼
- ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- Firebase Rulesã§ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒé©åˆ‡ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### Stripeæ±ºæ¸ˆã‚¨ãƒ©ãƒ¼
- Webhookã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ãƒ†ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- Stripeè¨­å®šã§Webhookã‚¤ãƒ™ãƒ³ãƒˆãŒé©åˆ‡ã«é¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### èªè¨¼ã‚¨ãƒ©ãƒ¼
- Firebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§èªè¨¼æ–¹æ³•ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- æ‰¿èªæ¸ˆã¿ãƒ‰ãƒ¡ã‚¤ãƒ³ã«localhost:3000ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

## ğŸ”— å‚è€ƒãƒªãƒ³ã‚¯
- [Firebase Console](https://console.firebase.google.com/)
- [Stripe Dashboard](https://dashboard.stripe.com/)
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæŠ€è¡“ä»•æ§˜æ›¸](./docs/æŠ€è¡“ä»•æ§˜æ›¸.md)
- [APIè¨­è¨ˆæ›¸](./docs/APIè¨­è¨ˆ.md)
- [ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸](./docs/ãƒ†ã‚¹ãƒˆ.md)

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
MIT 